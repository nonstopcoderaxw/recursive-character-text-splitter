### desc

1. split a paragraph into a list of chunks recursively by a list of separators
2. optimize the chunks by the defined chunk size and chunk overlapping
3. the chunk length is usually measured LLM tokens

### examples

| **Scenario**                     | **Input**                                                                                                                                                   | **Output**                                                                                                          | **Description**                                                                                                                                                 |
| -------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1: Simple Text Within Chunk Size | `text = "This is a simple test text."`<br>`chunk_size=50, chunk_overlap=10`                                                                                 | `["This is a simple test text."]`                                                                                   | The text is shorter than the `chunk_size` (50). It is returned as a single chunk.                                                                               |
| 2: Long Text Without Separators  | `text = "abcdefghijklmno"`<br>`chunk_size=10, chunk_overlap=2`                                                                                              | `["abcdefghij", "ijklmnop"]`                                                                                        | The text is split into chunks of size 10. An overlap of 2 characters (`"ij"`) is maintained between chunks.                                                     |
| 3: Text With Separators          | `text = "This is a test. Let's split it into chunks."`<br>`chunk_size=20, chunk_overlap=5, separators=[" ", "\n"]`                                          | `["This is a test.", "test. Let's split it", "split it into chunks."]`                                              | The text is split based on spaces. Chunks are formed within the `chunk_size` limit, with an overlap of 5 characters maintained between chunks.                  |
| 4: Nested Separators             | `text = "Chunk one.\nChunk two.\n\nChunk three is larger."`<br>`chunk_size=15, chunk_overlap=5, separators=["\n\n", "\n", " "]`                             | `["Chunk one.", "one. Chunk two.", "Chunk two.", "two. Chunk three", "Chunk three is", "three is larger."]`         | The text is split recursively by separators in order of priority: `"\n\n"`, `"\n"`, and `" "`. Chunks are created while maintaining an overlap of 5 characters. |
| 5: Very Long Text                | `text = "A" * 200`<br>`chunk_size=50, chunk_overlap=10`                                                                                                     | `["AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA", ...]` | A 200-character string is split into chunks of 50 characters each. Each chunk overlaps the previous one by 10 characters.                                       |
| 6: Multiple Short Sentences      | `text = "Sentence one. Sentence two. Sentence three."`<br>`chunk_size=25, chunk_overlap=5, separators=[". ", " "]`                                          | `["Sentence one.", "one. Sentence two.", "Sentence two. Sentence three."]`                                          | Sentences are split based on the `. ` separator first, followed by `" "`. Overlaps of 5 characters are maintained between chunks.                               |
| 7: Custom Length Function        | `text = "This is a test with custom length function."`<br>`chunk_size=5, chunk_overlap=2, separators=[" "], length_function=lambda text: len(text.split())` | `["This is a", "a test with", "with custom length", "length function."]`                                            | The custom length function treats each word as a "token." The text is split into chunks containing up to 5 words, with 2-word overlaps between chunks.          |

<small>\*personal use only, a mod from dify</small>.
